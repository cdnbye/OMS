{"version":3,"sources":["webpack:///./src/views/trackerConfig/seederStats.vue","webpack:///src/views/trackerConfig/seederStats.vue","webpack:///./src/views/trackerConfig/seederStats.vue?f601","webpack:///./src/views/trackerConfig/seederStats.vue?69e9"],"names":["render","_vm","this","_c","_self","directives","name","rawName","value","loading","expression","staticClass","staticStyle","attrs","model","callback","$$v","slot","action","on","$event","doAction","_v","_s","$t","jsonData","staticRenderFns","components","VueJsonPretty","data","url","accessToken","mounted","methods","pids","axios","headers","finally","workers","getStats","then","master","Object","worker","formatValue","beforeDestroy","clearInterval","component"],"mappings":"uHAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,WAAW,CAAC,CAACC,KAAK,UAAUC,QAAQ,YAAYC,MAAOP,EAAIQ,QAASC,WAAW,YAAYC,YAAY,iBAAiB,CAACR,EAAG,MAAM,CAACS,YAAY,CAAC,gBAAgB,SAAS,CAACT,EAAG,WAAW,CAACS,YAAY,CAAC,MAAQ,QAAQ,eAAe,OAAOC,MAAM,CAAC,YAAc,6BAA6BC,MAAM,CAACN,MAAOP,EAAIO,MAAOO,SAAS,SAAUC,GAAMf,EAAIO,MAAMQ,GAAKN,WAAW,UAAU,CAACP,EAAG,WAAW,CAACc,KAAK,WAAW,CAACd,EAAG,YAAY,CAACS,YAAY,CAAC,MAAQ,SAASC,MAAM,CAAC,KAAO,UAAU,YAAc,UAAUI,KAAK,UAAUH,MAAM,CAACN,MAAOP,EAAIiB,OAAQH,SAAS,SAAUC,GAAMf,EAAIiB,OAAOF,GAAKN,WAAW,WAAW,CAACP,EAAG,YAAY,CAACU,MAAM,CAAC,MAAQ,UAAU,MAAQ,aAAaV,EAAG,YAAY,CAACU,MAAM,CAAC,MAAQ,OAAO,MAAQ,UAAUV,EAAG,YAAY,CAACU,MAAM,CAAC,MAAQ,UAAU,MAAQ,WAAW,IAAI,IAAI,GAAGV,EAAG,YAAY,CAACU,MAAM,CAAC,KAAO,WAAWM,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOnB,EAAIoB,cAAc,CAACpB,EAAIqB,GAAGrB,EAAIsB,GAAGtB,EAAIuB,GAAG,kBAAkB,GAAGrB,EAAG,kBAAkB,CAACU,MAAM,CAAC,SAAW,GAAG,eAAiB,GAAG,kBAAmB,EAAM,KAAOZ,EAAIwB,aAAa,IAE5lCC,EAAkB,G,mrCCyBP,OACfpB,wBACAqB,YACAC,mBAEAC,KALA,WAMA,OACApB,WACAqB,OACAC,eACAN,YACAP,UACAV,WAGAwB,QAfA,WAeA,WACA,oBAAI,EAAJ,MAAI,EAAJ,cACA,WACA,mBACA,gBACA,mCACA,eACA,MAEAC,SACAZ,SADA,WACA,WAEA,GADA,gBACA,+CACA,IADI,EACJ,8FADA,IAEAa,GAFA,IAEA,0CACAC,uEACAC,SACA,6CAEAC,SAAA,WACA,iBARA,mCAWA,sBACAF,sDACAG,4BACA,CACAF,SACA,6CAEAC,SAAA,WACA,gBAGA,cACA,gBAEAE,SA5BA,WA4BA,WACA,gBACAJ,2BACAC,SACA,6CAEAI,MAAA,YACA,aACA,WAAI,EAAJ,UACAC,iCACA,kBACAA,+DAEA,GACAC,oCACA,WACA,aACAC,gCACAA,qCACAA,0CAEA,kBACAA,+DAEA,kBACAA,gDAEA,WACAA,qCAIA,gBACAN,SAAA,WACA,iBAGAO,YAjEA,SAiEApC,GACA,wBACA,wCAGAqC,cA9FA,WA+FAC,4BC1HoW,I,YCOhWC,EAAY,eACd,EACA/C,EACA0B,GACA,EACA,KACA,WACA,MAIa,aAAAqB,E","file":"js/chunk-2d237d62.7e65ba5b.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"app-container\"},[_c('div',{staticStyle:{\"margin-bottom\":\"10px\"}},[_c('el-input',{staticStyle:{\"width\":\"350px\",\"margin-right\":\"5px\"},attrs:{\"placeholder\":\"worker pid, url or number\"},model:{value:(_vm.value),callback:function ($$v) {_vm.value=$$v},expression:\"value\"}},[_c('template',{slot:\"prepend\"},[_c('el-select',{staticStyle:{\"width\":\"110px\"},attrs:{\"slot\":\"prepend\",\"placeholder\":\"Select\"},slot:\"prepend\",model:{value:(_vm.action),callback:function ($$v) {_vm.action=$$v},expression:\"action\"}},[_c('el-option',{attrs:{\"label\":\"Restart\",\"value\":\"restart\"}}),_c('el-option',{attrs:{\"label\":\"Kill\",\"value\":\"stop\"}}),_c('el-option',{attrs:{\"label\":\"Workers\",\"value\":\"ping\"}})],1)],1)],2),_c('el-button',{attrs:{\"type\":\"warning\"},on:{\"click\":function($event){return _vm.doAction()}}},[_vm._v(_vm._s(_vm.$t('common.ok')))])],1),_c('vue-json-pretty',{attrs:{\"showIcon\":\"\",\"showLineNumber\":\"\",\"showDoubleQuotes\":false,\"data\":_vm.jsonData}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"app-container\" v-loading=\"loading\">\n    <div style=\"margin-bottom: 10px\">\n      <el-input placeholder=\"worker pid, url or number\" v-model=\"value\" style=\"width: 350px; margin-right: 5px\">\n        <template slot=\"prepend\" >\n          <el-select v-model=\"action\" slot=\"prepend\" placeholder=\"Select\" style=\"width: 110px\">\n            <el-option label=\"Restart\" value=\"restart\"></el-option>\n            <el-option label=\"Kill\" value=\"stop\"></el-option>\n            <el-option label=\"Workers\" value=\"ping\"></el-option>\n          </el-select>\n        </template>\n      </el-input>\n      <el-button type=\"warning\" @click=\"doAction()\">{{ $t('common.ok') }}</el-button>\n    </div>\n    <vue-json-pretty\n        showIcon\n        showLineNumber\n        :showDoubleQuotes=\"false\"\n        :data=\"jsonData\" />\n  </div>\n</template>\n\n<script>\nimport axios from 'axios'\nimport { formatTraffic } from '@/utils/format'\nimport VueJsonPretty from 'vue-json-pretty';\nimport 'vue-json-pretty/lib/styles.css';\nexport default {\n  name: \"AdminSeederStats\",\n  components: {\n    VueJsonPretty,\n  },\n  data() {\n    return {\n      loading: false,\n      url: '',\n      accessToken: '',\n      jsonData: {},\n      action: '',\n      value: '',\n    }\n  },\n  mounted() {\n    const { url, accessToken } = this.$route.query\n    this.url = url\n    this.accessToken = accessToken\n    this.getStats()\n    this.timer = setInterval(() => {\n      this.getStats()\n    }, 20000)\n  },\n  methods: {\n    doAction() {\n      this.loading = true\n      if (this.action === 'restart' || this.action === 'stop') {\n        const pids = this.value.split(' ').filter(pid => !!pid).map(pid => Number(pid))\n        for (let pid of pids) {\n          axios.post(`${this.url}/${this.action}/${pid}`, {}, {\n            headers: {\n              \"X-Access-Token\": this.accessToken || undefined,\n            }\n          }).finally(() => {\n            this.loading = false\n          })\n        }\n      } else if (this.action === 'ping') {\n        axios.post(`${this.url}/${this.action}`, {\n          workers: Number(this.value),\n        }, {\n          headers: {\n            \"X-Access-Token\": this.accessToken || undefined,\n          }\n        }).finally(() => {\n          this.loading = false\n        })\n      }\n      this.value = ''\n      this.action = ''\n    },\n    getStats() {\n      this.loading = true\n      axios.get(this.url+'/stats',{\n        headers: {\n          \"X-Access-Token\": this.accessToken || undefined,\n        }\n      }).then(res => {\n        const json = res.data\n        const { master, workers } = json\n        master.memory = this.formatValue(master.memory)\n        if (master.averageUplink) {\n          master.averageUplink = `${Math.round(master.averageUplink)}Mbps`\n        }\n        if (workers) {\n          Object.keys(workers).forEach(key => {\n            const worker = workers[key]\n            if (worker.seedFrom) {\n              worker.seedFrom = new Date(worker.seedFrom)\n              worker.uploaded = this.formatValue(worker.uploaded)\n              worker.downloaded = this.formatValue(worker.downloaded)\n            }\n            if (worker.averageUplink) {\n              worker.averageUplink = `${Math.round(worker.averageUplink)}Mbps`\n            }\n            if (worker.diskCacheSize) {\n              worker.diskCacheSize = this.formatValue(worker.diskCacheSize)\n            }\n            if (worker.memory) {\n              worker.memory = this.formatValue(worker.memory)\n            }\n          })\n        }\n        this.jsonData = json\n      }).finally(() => {\n        this.loading = false\n      })\n    },\n    formatValue(value) {\n      const obj = formatTraffic(value)\n      return `${obj.num}${obj.unit}`\n    }\n  },\n  beforeDestroy() {\n    clearInterval(this.timer)\n  }\n}\n</script>\n\n<style scoped>\n\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./seederStats.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./seederStats.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./seederStats.vue?vue&type=template&id=53cf68a0&scoped=true&\"\nimport script from \"./seederStats.vue?vue&type=script&lang=js&\"\nexport * from \"./seederStats.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"53cf68a0\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}