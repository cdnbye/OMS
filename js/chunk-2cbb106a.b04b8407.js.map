{"version":3,"sources":["webpack:///./src/views/financeInfo/admin/IncomeTrend.vue","webpack:///src/views/financeInfo/admin/IncomeTrend.vue","webpack:///./src/views/financeInfo/admin/IncomeTrend.vue?d462","webpack:///./src/views/financeInfo/admin/IncomeTrend.vue?bf54","webpack:///./src/api/finance.js","webpack:///./src/components/LineChart/index.vue","webpack:///src/components/LineChart/index.vue","webpack:///./src/components/LineChart/index.vue?4292","webpack:///./src/components/LineChart/index.vue?cbcb"],"names":["render","_vm","this","_c","_self","staticClass","attrs","data","option","staticRenderFns","name","components","LineChart","CNY","USD","xData","yName","mounted","fetchIncomeTrend","Object","incomesCNY","formattedMonths","formattedIncomesCNY","incomesUSD","formattedIncomesUSD","component","financeInfo","request","url","method","fetchInvoices","updateInvoice","class","className","style","height","width","require","props","type","default","autoResize","chartData","required","secondChartData","showSecondYAxis","chart","optionData","unit","secondData","watch","deep","handler","val","window","sidebarElm","beforeDestroy","methods","sidebarResizeHandler","e","setOptions","legend","series","markPoint","itemStyle","normal","color","lineStyle","smooth","animationDuration","animationEasing","yAxisIndex","xAxis","boundaryGap","axisLabel","formatter","axisTick","show","grid","left","right","bottom","top","containLabel","tooltip","trigger","padding","axisPointer","textStyle","align","yAxis","options","max","min","position","initChart"],"mappings":"yHAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,iBAAiB,CAACF,EAAG,YAAY,CAACG,MAAM,CAAC,aAAaL,EAAIM,KAAK,OAASN,EAAIO,WAAW,IAE5KC,EAAkB,G,8CCQP,GACfC,mBACAC,YACAC,kBAEAL,KALA,WAMA,OACAA,MACAM,OACAC,QAEAN,QACAO,SACAC,cAIAC,QAjBA,WAiBA,WACAC,mCACA,aACA,gBACA,gBACA,KACA,KACA,KACAC,oCACAC,0BACAC,yCACAC,sBAGAH,oCACAI,0BACAC,sBAGA,aACA,aACA,sBChDmX,I,YCO/WC,EAAY,eACd,EACAzB,EACAS,GACA,EACA,KACA,WACA,MAIa,aAAAgB,E,2CClBf,wJAGO,SAASC,IACd,OAAOC,eAAQ,CACbC,IAAK,iBACLC,OAAQ,QAKL,SAASC,IACZ,OAAOH,eAAQ,CACXC,IAAK,mBACLC,OAAQ,QAKT,SAASE,EAAcxB,GAC1B,OAAOoB,eAAQ,CACXC,IAAK,yBACLC,OAAQ,OACRtB,SAKD,SAASW,IACZ,OAAOS,eAAQ,CACXC,IAAK,uBACLC,OAAQ,U,kCC/BhB,IAAI7B,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAAC6B,MAAM/B,EAAIgC,UAAUC,MAAO,CAACC,OAAOlC,EAAIkC,OAAOC,MAAMnC,EAAImC,UAEjI3B,EAAkB,G,4CCGtB,YACA4B,EAAQA,QAGO,OACfC,OACAL,WACAM,YACAC,iBAEAJ,OACAG,YACAC,gBAEAL,QACAI,YACAC,iBAEAC,YACAF,aACAC,YAEAE,WACAH,YACAI,aAEAC,iBACAL,YACAI,aAEAnC,QACA+B,YACAI,aAEAE,iBACAN,eAGAhC,KAlCA,WAmCA,OACAuC,WACAC,YACAhC,SACAiC,SAEAzC,QACA0C,gBAGAC,OACAN,iBACAO,QACAC,QAFA,SAEAC,GACA,kBACA,oBAGAX,WACAS,QACAC,QAFA,SAEAC,GACA,YACA,oBAGA7C,QACA2C,QACAC,QAFA,SAEAC,GACA,kBACA,qBAIApC,QApEA,WAoEA,WACA,iBACA,kBACA,gDACA,SACA,mBAEA,KACAqC,wDAIA,8DACAC,+DAEAC,cAnFA,WAoFA,eAGA,iBACAF,0DAGA,8DACA,oEAEA,qBACA,kBAEAG,SACAC,qBADA,SACAC,GACA,0BACA,wBAGAC,WANA,WAMA,WACA,KACA,KACA,wBACAzC,8CACA0C,UACAC,QACApD,OACAqD,WACAxD,MACA,CAAAgC,WAAA7B,YACA,CAAA6B,WAAA7B,cAGAsD,WACAC,QACAC,WACAC,WACAD,WACA9B,WAIAgC,UACA7B,YACAhC,eACA8D,uBACAC,kCAGAnD,oDACA0C,UACAC,QACApD,OACAqD,WACAxD,MACA,CAAAgC,WAAA7B,YACA,CAAA6B,WAAA7B,cAGA6D,aACAH,UACA7B,YACAhC,qBACA8D,uBACAC,kCAGA,OACAE,OACAjE,2BACAkE,eACAC,WACAC,sBACA,KACA,iCAIAC,UACAC,UAGAC,MACAC,QACAC,SACAC,UACAC,OACAC,iBAEAC,SACAC,eACAC,eACAC,aACAhD,cAEAiD,WACAC,eAGAC,OACA,CACAhF,iIACAkE,UACAC,WAIAhB,QACAtD,QAEAuD,UAEA,sBACA6B,cACAjF,iBACAkF,QACAC,MACAjB,UACAC,SAEAiB,iBACApB,WACAC,yBAIA,yBAEAoB,UAnHA,WAoHA,uCACA,qBC/N8V,I,YCO1VtE,EAAY,eACd,EACAzB,EACAS,GACA,EACA,KACA,KACA,MAIa,OAAAgB,E","file":"js/chunk-2cbb106a.b04b8407.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"app-container\"},[_c('LineChart',{attrs:{\"chart-data\":_vm.data,\"option\":_vm.option}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"app-container\">\n    <LineChart :chart-data=\"data\" :option=\"option\" />\n  </div>\n</template>\n\n<script>\nimport LineChart from '@/components/LineChart'\nimport { fetchIncomeTrend } from '@/api/finance'\n\nexport default {\n  name: \"IncomeTrend\",\n  components: {\n    LineChart,\n  },\n  data() {\n    return {\n      data: {\n        CNY: [],\n        USD: []\n      },\n      option: {\n        xData: [],\n        yName: '收入',\n      },\n    }\n  },\n  mounted() {\n    fetchIncomeTrend().then(res => {\n      const { data } = res\n      const incomesCNY = data.incomes_cny\n      const incomesUSD = data.incomes_usd\n      const formattedIncomesCNY = []\n      const formattedIncomesUSD = []\n      const formattedMonths = []\n      Object.keys(incomesCNY).forEach(year => {\n        incomesCNY[year].forEach(item => {\n          formattedMonths.push(`${year}-${item.month}`)\n          formattedIncomesCNY.push(item.total)\n        })\n      })\n      Object.keys(incomesUSD).forEach(year => {\n        incomesUSD[year].forEach(item => {\n          formattedIncomesUSD.push(item.total)\n        })\n      })\n      this.data.CNY = formattedIncomesCNY\n      this.data.USD = formattedIncomesUSD\n      this.option.xData = formattedMonths\n    })\n  },\n}\n</script>\n\n<style scoped>\n\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./IncomeTrend.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./IncomeTrend.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./IncomeTrend.vue?vue&type=template&id=cc80bd24&scoped=true&\"\nimport script from \"./IncomeTrend.vue?vue&type=script&lang=js&\"\nexport * from \"./IncomeTrend.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"cc80bd24\",\n  null\n  \n)\n\nexport default component.exports","import request from '@/utils/request'\n\n// 获取财务信息\nexport function financeInfo() {\n  return request({\n    url: 'finance/global',\n    method: 'get'\n  })\n}\n\n// 获取带开票列表\nexport function fetchInvoices() {\n    return request({\n        url: `finance/invoices`,\n        method: 'get'\n    })\n}\n\n// 开票状态变动\nexport function updateInvoice(data) {\n    return request({\n        url: `finance/invoice_finish`,\n        method: 'post',\n        data\n    })\n}\n\n// 收入趋势\nexport function fetchIncomeTrend() {\n    return request({\n        url: `finance/income_trend`,\n        method: 'get'\n    })\n}\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{class:_vm.className,style:({height:_vm.height,width:_vm.width})})\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div :class=\"className\" :style=\"{height:height,width:width}\"/>\n</template>\n\n<script>\nlet echarts = require('echarts/lib/echarts')\nrequire('echarts/theme/macarons') // echarts theme\nimport { debounce } from '@/utils'\n\nexport default {\n  props: {\n    className: {\n      type: String,\n      default: 'chart'\n    },\n    width: {\n      type: String,\n      default: '100%'\n    },\n    height: {\n      type: String,\n      default: '350px'\n    },\n    autoResize: {\n      type: Boolean,\n      default: true\n    },\n    chartData: {\n      type: Object,\n      required: true\n    },\n    secondChartData: {\n      type: Object,\n      required: false\n    },\n    option: {\n      type: Object,\n      required: true\n    },\n    showSecondYAxis: {\n      type: Boolean,\n    }\n  },\n  data() {\n    return {\n      chart: null,\n      optionData: {\n        xData: [],\n        unit: ''\n      },\n      data: {},\n      secondData: {}\n    }\n  },\n  watch: {\n    secondChartData: {\n      deep: true,\n      handler(val) {\n        this.secondData = val\n        this.setOptions()\n      }\n    },\n    chartData: {\n      deep: true,\n      handler(val) {\n        this.data = val\n        this.setOptions()\n      }\n    },\n    option: {\n      deep: true,\n      handler(val) {\n        this.optionData = val\n        this.setOptions()\n      }\n    }\n  },\n  mounted() {\n    this.initChart()\n    if (this.autoResize) {\n      this.__resizeHandler = debounce(() => {\n        if (this.chart) {\n          this.chart.resize()\n        }\n      }, 100)\n      window.addEventListener('resize', this.__resizeHandler)\n    }\n\n    // 监听侧边栏的变化\n    const sidebarElm = document.getElementsByClassName('sidebar-container')[0]\n    sidebarElm.addEventListener('transitionend', this.sidebarResizeHandler)\n  },\n  beforeDestroy() {\n    if (!this.chart) {\n      return\n    }\n    if (this.autoResize) {\n      window.removeEventListener('resize', this.__resizeHandler)\n    }\n\n    const sidebarElm = document.getElementsByClassName('sidebar-container')[0]\n    if (sidebarElm) sidebarElm.removeEventListener('transitionend', this.sidebarResizeHandler)\n\n    this.chart.dispose()\n    this.chart = null\n  },\n  methods: {\n    sidebarResizeHandler(e) {\n      if (e.propertyName === 'width') {\n        this.__resizeHandler()\n      }\n    },\n    setOptions() {\n      const series = []\n      const legend = []\n      const colors = ['#3888fa', '#FF005A']\n      Object.keys(this.data).forEach((item, index) => {\n        legend.push(item)\n        series.push({\n          name: item,\n          markPoint: {\n            data: [\n              {type: 'max', name: '最大值'},\n              {type: 'min', name: '最小值'}\n            ]\n          },\n          itemStyle: {\n            normal: {\n              color: colors[index],\n              lineStyle: {\n                color: colors[index],\n                width: 2\n              }\n            }\n          },\n          smooth: true,\n          type: 'line',\n          data: this.data[item],\n          animationDuration: 2800,\n          animationEasing: 'cubicInOut'\n        })\n      })\n      Object.keys(this.secondData).forEach((item, index) => {\n        legend.push(item)\n        series.push({\n          name: item,\n          markPoint: {\n            data: [\n              {type: 'max', name: '最大值'},\n              {type: 'min', name: '最小值'}\n            ]\n          },\n          yAxisIndex: 1,\n          smooth: true,\n          type: 'line',\n          data: this.secondData[item],\n          animationDuration: 2800,\n          animationEasing: 'cubicInOut'\n        })\n      })\n      const options = {\n        xAxis: {\n          data: this.optionData.xData,\n          boundaryGap: false,\n          axisLabel: {\n            formatter: function(value) {\n              if(value) {\n                return value.split(\" \").join(\"\\n\");\n              }\n            }\n          },\n          axisTick: {\n            show: false\n          }\n        },\n        grid: {\n          left: 10,\n          right: 30,\n          bottom: 20,\n          top: 30,\n          containLabel: true\n        },\n        tooltip: {\n          trigger: 'axis',\n          padding: [5, 10],\n          axisPointer: {\n            type: 'cross'\n          },\n          textStyle: {\n            align: 'left'\n          }\n        },\n        yAxis: [\n          {\n            name: this.optionData.unit ? `${this.optionData.yName}(${this.optionData.unit})` : `${this.optionData.yName}`,\n            axisTick: {\n              show: false\n            },\n          },\n        ],\n        legend: {\n          data: legend\n        },\n        series\n      }\n      if (this.showSecondYAxis) {\n        options.yAxis.push({\n          name: 'P2P Ratio',\n          max: 100,\n          min: 0,\n          axisTick: {\n            show: false\n          },\n          position: 'right',\n          axisLabel: {\n            formatter: '{value} %'\n          }\n        })\n      }\n      this.chart.setOption(options)\n    },\n    initChart() {\n      this.chart = echarts.init(this.$el, 'macarons')\n      this.setOptions()\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=39857ec8&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}