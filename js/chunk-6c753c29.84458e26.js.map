{"version":3,"sources":["webpack:///./src/views/p2pConfig/user/p2pSwitch.vue","webpack:///src/views/p2pConfig/user/p2pSwitch.vue","webpack:///./src/views/p2pConfig/user/p2pSwitch.vue?8849","webpack:///./src/views/p2pConfig/user/p2pSwitch.vue?7738","webpack:///./src/api/user/p2pConfig.js"],"names":["render","_vm","this","_c","_self","style","device","directives","name","rawName","value","loading","expression","attrs","tableData","$t","formatterStatus","scopedSlots","_u","key","fn","scope","row","blocked","_v","_s","_e","disable_p2p","on","switchChange","staticClass","tableParam","pageSize","page","handleSizeChange","handleCurrentChange","staticRenderFns","data","applyAll","id","domain","computed","mapGetters","mounted","methods","fetchTableData","fetchUserDomain","isvalid","catch","handleP2PConfig","uid","p2pConfig","then","title","message","type","item","disable","component","user_id","domain_id","request","url","method","p2pConfigWifiOnly","p2pConfigRatio","updateSignalAddr","updateStuns"],"mappings":"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","file":"js/chunk-6c753c29.84458e26.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{style:(_vm.device === 'mobile' ? '' : 'padding: 30px 120px')},[_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],attrs:{\"border\":\"\",\"data\":_vm.tableData}},[_c('el-table-column',{attrs:{\"align\":\"center\",\"prop\":\"domain\",\"label\":_vm.$t('p2pConfig.name'),\"min-width\":\"150\"}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"formatter\":_vm.formatterStatus,\"label\":_vm.$t('p2pConfig.status'),\"width\":\"100\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',{style:(scope.row.blocked ? 'color: red':'')},[_vm._v(\"\\n          \"+_vm._s(_vm.formatterStatus(scope.row))+\"\\n        \")])]}}])}),_c('el-table-column',{attrs:{\"label\":_vm.$t('domainTable.operation'),\"align\":\"center\",\"min-width\":\"50\",\"width\":\"150\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(!scope.row.blocked )?_c('el-switch',{attrs:{\"value\":!scope.row.disable_p2p,\"active-color\":\"#13ce66\",\"inactive-color\":\"#ff4949\"},on:{\"change\":value => _vm.switchChange(scope.row, value)}}):_vm._e()]}}])})],1),_c('div',{staticClass:\"pagination-container\"},[_c('el-pagination',{attrs:{\"layout\":\"sizes, prev, pager, next\",\"page-sizes\":[10, 20, 50, 100],\"page-size\":_vm.tableParam.pageSize,\"current-page\":_vm.tableParam.page},on:{\"size-change\":_vm.handleSizeChange,\"current-change\":_vm.handleCurrentChange}})],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div :style=\"device === 'mobile' ? '' : 'padding: 30px 120px'\">\n    <el-table border :data=\"tableData\" v-loading=\"loading\">\n      <el-table-column align=\"center\" prop=\"domain\" :label=\"$t('p2pConfig.name')\" min-width=\"150\" ></el-table-column>\n      <el-table-column align=\"center\" :formatter=\"formatterStatus\" :label=\"$t('p2pConfig.status')\" width=\"100\">\n        <template slot-scope=\"scope\">\n          <span :style=\"scope.row.blocked ? 'color: red':''\">\n            {{ formatterStatus(scope.row) }}\n          </span>\n        </template>\n      </el-table-column>\n      <el-table-column :label=\"$t('domainTable.operation')\" align=\"center\"  min-width=\"50\" width=\"150\">\n        <template slot-scope=\"scope\">\n          <el-switch v-if=\"!scope.row.blocked \" :value=\"!scope.row.disable_p2p\" active-color=\"#13ce66\" inactive-color=\"#ff4949\" @change=\"value => switchChange(scope.row, value)\"> </el-switch>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <div class=\"pagination-container\">\n      <el-pagination\n              layout=\"sizes, prev, pager, next\"\n              :page-sizes=\"[10, 20, 50, 100]\"\n              :page-size=\"tableParam.pageSize\"\n              :current-page=\"tableParam.page\"\n              @size-change=\"handleSizeChange\"\n              @current-change=\"handleCurrentChange\">\n      </el-pagination>\n    </div>\n\n  </div>\n</template>\n\n<script>\nimport { fetchUserDomain } from '@/api/userDomain'\nimport { p2pConfig } from '@/api/user/p2pConfig'\nimport { mapGetters } from 'vuex'\n\nconst APPLY_TO_ALL = '*Apply To All*'\n\nexport default {\n  name: 'p2pSwitch',\n  data() {\n    return {\n      loading: false,\n      tableData: [],\n      tableParam: {\n          page: 1,\n          pageSize: 10\n      },\n      applyAll: {\n        id: 0,\n        domain: APPLY_TO_ALL,\n        blocked: false,\n        disable_p2p: false,\n      }\n    }\n  },\n  computed: {\n    ...mapGetters([\n      'device'\n    ])\n  },\n  mounted() {\n    this.fetchTableData()\n  },\n  methods: {\n    formatterStatus(row) {\n      if(row.blocked) {\n          return this.$t('common.illegal')\n      }\n      // if(row.reviewing) {\n      //   return this.$t('common.reviewing')\n      // }\n      return row.disable_p2p ? this.$t('p2pConfig.close') : this.$t('p2pConfig.open')\n    },\n    fetchTableData(page=this.tableParam.page, pageSize=this.tableParam.pageSize) {\n      this.loading = true\n      fetchUserDomain(page, pageSize, {isvalid: true}).then(res => {\n        if(res.data) {\n          this.tableData = res.data\n          if (this.tableData.length > 1) {\n            this.applyAll.uid = this.tableData[0].uid\n            this.tableData.unshift(this.applyAll)\n          }\n        }\n        this.loading = false\n      }).catch(() => {\n        this.loading = false\n      })\n    },\n    handleP2PConfig(uid, id, data) {\n      this.loading = true\n      p2pConfig(uid, id, data)\n        .then(res => {\n          if(res.data.succeed) {\n            this.$notify({\n                title: this.$t('common.success'),\n                message: this.$t('p2pConfig.configSuccess'),\n                type: 'success'\n            });\n            if (id === 0) {\n              this.fetchTableData()\n            }\n            this.tableData.forEach(item => {\n              if(item.id === id) {\n                item.disable_p2p = data.disable\n              }\n            })\n          } else {\n            this.$notify.error({\n                title: this.$t('common.error'),\n                message: this.$t('p2pConfig.configFail'),\n            });\n          }\n          this.loading = false\n        })\n        .catch(() => {\n          this.loading = false\n        })\n    },\n    switchChange(domain, value) {\n      const data = { disable: !value }\n      this.handleP2PConfig(domain.uid, domain.id, data)\n    },\n    handleSizeChange(pageSize) {\n        this.tableParam.pageSize = pageSize\n        this.fetchTableData()\n    },\n    handleCurrentChange(page) {\n        this.tableParam.page = page\n        this.fetchTableData()\n    },\n  },\n}\n</script>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./p2pSwitch.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./p2pSwitch.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./p2pSwitch.vue?vue&type=template&id=072cde08&\"\nimport script from \"./p2pSwitch.vue?vue&type=script&lang=js&\"\nexport * from \"./p2pSwitch.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import request from '@/utils/request'\n\n// 用户配置网站p2p开关\nexport function p2pConfig(user_id, domain_id, data) {\n  return request({\n    url: `user/user_id/${user_id}/domain/domain_id/${domain_id}/control`,\n    method: 'post',\n    data\n  })\n}\n\n// 配置wifi only\nexport function p2pConfigWifiOnly(user_id, domain_id, data) {\n    return request({\n        url: `user/user_id/${user_id}/domain/domain_id/${domain_id}/control/wifi_only`,\n        method: 'post',\n        data\n    })\n}\n\n// 配置p2p激活比率\nexport function p2pConfigRatio(user_id, domain_id, data) {\n    return request({\n        url: `user/user_id/${user_id}/domain/domain_id/${domain_id}/control/ratio`,\n        method: 'post',\n        data\n    })\n}\n\n// 配置信令地址\nexport function updateSignalAddr(user_id, domain_id, data) {\n    return request({\n        url: `user/user_id/${user_id}/domain/domain_id/${domain_id}/control/signal`,\n        method: 'post',\n        data\n    })\n}\n\n// 新增stun\nexport function updateStuns(user_id, domain_id, data) {\n    return request({\n        url: `user/user_id/${user_id}/domain/domain_id/${domain_id}/control/stun`,\n        method: 'post',\n        data\n    })\n}\n\n"],"sourceRoot":""}