{"version":3,"sources":["webpack:///./src/views/package/OrderDetail.vue","webpack:///src/views/package/OrderDetail.vue","webpack:///./src/views/package/OrderDetail.vue?6b5e","webpack:///./src/views/package/OrderDetail.vue?eceb","webpack:///./src/assets/ali_pay.png","webpack:///./src/api/user/package.js","webpack:///./src/assets/paypal.jpeg","webpack:///./src/assets/coinbase.png","webpack:///./src/views/package/OrderDetail.vue?fee3"],"names":["render","_vm","this","_c","_self","directives","name","rawName","value","payLoading","expression","style","device","padding","attrs","$t","tableData","staticClass","_v","_s","totalPrice","currency","payImg","ali","on","alipayClick","_e","paypal","paypalClick","showCrypto","coinbase","coinbaseClick","cantBuyVisible","$event","slot","staticRenderFns","data","orderID","computed","mapGetters","mounted","methods","formatData","item","console","handleFetchPayUrl","payMethod","fetchPayUrl","then","window","catch","component","module","exports","fetchPackage","uid","url","request","method","fetchMonthlyPackage","createOrder","userID","updateCryptoTrade","origin","location","pathname","param","checkAlipayOrder","checkPaypalOrder","paymentID","payerID","checkIn","getInvoiceInfo","createInvoice"],"mappings":"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","file":"js/chunk-03c184cc.984f2944.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.payLoading),expression:\"payLoading\"}],style:(_vm.device === 'mobile' ? {} : {padding: '30px 250px'}),attrs:{\"element-loading-text\":_vm.$t('package.payLoadingTip')}},[_c('el-table',{attrs:{\"data\":_vm.tableData,\"border\":\"\"}},[_c('el-table-column',{attrs:{\"align\":\"left\",\"prop\":\"subject\",\"label\":_vm.$t('package.packageInfo')}}),_c('el-table-column',{attrs:{\"align\":\"left\",\"prop\":\"price\",\"label\":_vm.$t('package.unitPrice')}}),_c('el-table-column',{attrs:{\"align\":\"left\",\"prop\":\"amount\",\"label\":_vm.$t('package.quantity')}}),_c('el-table-column',{attrs:{\"align\":\"left\",\"prop\":\"total\",\"label\":_vm.$t('package.expense')}})],1),_c('div',{staticClass:\"pay-submit\"},[_c('el-card',{attrs:{\"shadow\":\"never\"}},[_c('div',[_c('div',{staticClass:\"cost\"},[_c('span',[_vm._v(_vm._s(_vm.$t('package.total')))]),_c('span',{staticClass:\"price\"},[_c('em',[_vm._v(\" \"+_vm._s(_vm.totalPrice))]),_c('span',[_vm._v(_vm._s(_vm.currency === 'CNY' ? ' ￥' : ' $'))])])]),_c('div',{staticClass:\"payMethod\"},[(_vm.currency === 'CNY')?_c('img',{attrs:{\"src\":_vm.payImg.ali},on:{\"click\":_vm.alipayClick}}):_vm._e(),(_vm.currency !== 'CNY')?_c('img',{attrs:{\"src\":_vm.payImg.paypal},on:{\"click\":_vm.paypalClick}}):_vm._e(),(_vm.currency !== 'CNY' && _vm.showCrypto)?_c('img',{attrs:{\"src\":_vm.payImg.coinbase},on:{\"click\":_vm.coinbaseClick}}):_vm._e()])])])],1),_c('el-dialog',{attrs:{\"visible\":_vm.cantBuyVisible,\"width\":_vm.device === 'mobile' ? '80%' : '30%'},on:{\"update:visible\":function($event){_vm.cantBuyVisible=$event}}},[_c('span',[_vm._v(_vm._s(_vm.$t('package.systemError')))]),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.cantBuyVisible = false}}},[_vm._v(_vm._s(_vm.$t('common.ok')))])],1)])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div :style=\"device === 'mobile' ? {} : {padding: '30px 250px'}\" v-loading=\"payLoading\" :element-loading-text=\"$t('package.payLoadingTip')\">\n    <el-table :data=\"tableData\" border>\n      <el-table-column align=\"left\" prop=\"subject\" :label=\"$t('package.packageInfo')\"></el-table-column>\n      <el-table-column align=\"left\" prop=\"price\" :label=\"$t('package.unitPrice')\"></el-table-column>\n      <el-table-column align=\"left\" prop=\"amount\" :label=\"$t('package.quantity')\"></el-table-column>\n      <el-table-column align=\"left\" prop=\"total\" :label=\"$t('package.expense')\"></el-table-column>\n    </el-table>\n    <div class=\"pay-submit\">\n      <el-card shadow=\"never\">\n        <div>\n          <div class=\"cost\">\n            <span>{{ $t('package.total') }}</span>\n            <span class=\"price\">\n              <em> {{ totalPrice }}</em>\n              <span>{{ currency === 'CNY' ? ' ￥' : ' $' }}</span>\n            </span>\n          </div>\n          <div class=\"payMethod\">\n            <img v-if=\"currency === 'CNY'\" style=\"\" :src=\"payImg.ali\" @click=\"alipayClick\" />\n\n            <img v-if=\"currency !== 'CNY'\" style=\"\" :src=\"payImg.paypal\" @click=\"paypalClick\" />\n<!--            <div v-if=\"currency !== 'CNY'\">-->\n<!--              <img style=\"width: 150px\" :src=\"payImg.credit\" />-->\n<!--            </div>-->\n            <img v-if=\"currency !== 'CNY' && showCrypto\" style=\"\" :src=\"payImg.coinbase\" @click=\"coinbaseClick\" />\n\n          </div>\n        </div>\n      </el-card>\n    </div>\n    <el-dialog :visible.sync=\"cantBuyVisible\" :width=\"device === 'mobile' ? '80%' : '30%'\">\n      <span>{{ $t('package.systemError') }}</span>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button type=\"primary\" @click=\"cantBuyVisible = false\">{{ $t('common.ok') }}</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex'\nimport { fetchPayUrl } from '@/api/user/package'\nimport { getItem } from '@/utils/storage'\nimport { LOCATION } from '@/constant'\n\nexport default {\n  name: 'OrderDetail',\n  data() {\n    return {\n      showCrypto: true,\n      payImg: {\n        ali: require('../../assets/ali_pay.png'),\n        paypal: require('../../assets/paypal.jpeg'),\n        coinbase: require('../../assets/coinbase.png'),\n        // credit: require('../../assets/credit_card.png')\n      },\n      payLoading: false,\n      cantBuyVisible: false,\n      tableData: [],\n      currency: '',\n      totalPrice: 0,\n      orderID: 0\n    }\n  },\n  computed: {\n    ...mapGetters([\n      'device'\n    ]),\n  },\n  mounted() {\n    if (getItem(LOCATION) === 'p1') {\n      this.showCrypto = false\n    }\n    if(this.$route.query.currency) {\n      this.formatData()\n    } else {\n      this.$router.push('/shopping/package')\n    }\n  },\n  methods: {\n    formatData() {\n      try {\n        this.tableData = [...JSON.parse(this.$route.query.buyData)]\n        // console.log(this.tableData)\n        this.tableData.forEach(item => {\n          item.total = item.amount ? (item.amount * item.price).toFixed(2) : item.price.toFixed(2)\n          if(!item.amount) {\n            item.amount = 1\n          }\n        })\n      } catch (e) {\n        console.error(e)\n        this.$router.push('/')\n      }\n      this.currency = this.$route.query.currency\n      this.totalPrice = this.$route.query.totalPrice\n      this.orderID = this.$route.query.orderID\n    },\n    paypalClick() {\n      this.handleFetchPayUrl('paypal')\n    },\n    alipayClick() {\n      this.handleFetchPayUrl('alipay')\n    },\n    coinbaseClick() {\n      this.handleFetchPayUrl('crypto')\n    },\n    handleFetchPayUrl(payMethod) {\n      this.payLoading = true\n      fetchPayUrl(payMethod, this.orderID, this.device)\n        .then(res => {\n          if(res.data.available) {\n            window.location.href = `${res.data.pay_url}`\n          } else {\n            this.payLoading = false\n            this.cantBuyVisible = true\n          }\n        })\n        .catch(err => {\n          this.payLoading = false\n          console.log(err)\n        })\n    },\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n  .pay-submit {\n    margin-top: 20px;\n    text-align: right;\n  }\n  .cost {\n    display: inline-block;\n    margin-right: 20px;\n    .price {\n      span {\n        vertical-align: top;\n        font-size: 16px;\n        line-height: 20px;\n        margin-right: 5px;\n        color: #ed711f;\n      }\n      em {\n        font-style: normal;\n        font-weight: 400;\n        font-size: 30px;\n        line-height: 30px;\n        color: #ed711f;\n      }\n    }\n  }\n  .payMethod {\n    display: flex;\n    align-items: center;\n    justify-content: space-around;\n    flex-wrap: wrap;\n    margin-top: 10px;\n    >img {\n      cursor: pointer;\n      width: 160px;\n    }\n  }\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OrderDetail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OrderDetail.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./OrderDetail.vue?vue&type=template&id=0db150e4&scoped=true&\"\nimport script from \"./OrderDetail.vue?vue&type=script&lang=js&\"\nexport * from \"./OrderDetail.vue?vue&type=script&lang=js&\"\nimport style0 from \"./OrderDetail.vue?vue&type=style&index=0&id=0db150e4&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0db150e4\",\n  null\n  \n)\n\nexport default component.exports","module.exports = __webpack_public_path__ + \"img/ali_pay.546a525b.png\";","import request from '@/utils/request'\n\n// 获取套餐信息\nexport function fetchPackage(uid) {\n    let url = `goods/flow_packet`\n    if (uid) {\n        url = `${url}?uid=${uid}`\n    }\n  return request({\n    url,\n    method: 'get'\n  })\n}\n\n// 获取包年包月套餐信息\nexport function fetchMonthlyPackage(uid) {\n    let url = `goods/monthly_packet`\n    if (uid) {\n        url = `${url}?uid=${uid}`\n    }\n  return request({\n    url,\n    method: 'get'\n  })\n}\n\n// 用户创建订单\nexport function createOrder(userID, data) {\n  return request({\n    url: `order/user_id/${userID}`,\n    method: 'post',\n    data\n  })\n}\n\n// 更新支付状态\nexport function updateCryptoTrade(data) {\n    return request({\n        url: `charge/crypto/trade`,\n        method: 'post',\n        data\n    })\n}\n\n// 获取支付地址\nexport function fetchPayUrl(payMethod, orderID, device) {\n  const origin = location.origin + location.pathname\n  const param = device === 'mobile' ? '&mobile=true' : ''\n  return request({\n    url: `charge/${payMethod}/pay?origin=${origin}&order_id=${orderID}${param}`,\n    method: 'get'\n  })\n}\n\n// 检查支付宝支付状态\nexport function checkAlipayOrder(orderID) {\n  return request({\n    url: `charge/alipay/query?order_id=${orderID}`,\n    method: 'get'\n  })\n}\n\n// 检查paypal支付状态\nexport function checkPaypalOrder(orderID, paymentID, payerID) {\n  return request({\n    url: `charge/paypal/query?order_id=${orderID}&payment_id=${paymentID}&payer_id=${payerID}`,\n    method: 'get'\n  })\n}\n\n// 用户签到\nexport function checkIn(userID, data) {\n  return request({\n    url: `user/user_id/${userID}/checkin`,\n    method: 'post',\n    data\n  })\n}\n\n// 获取开票信息\nexport function getInvoiceInfo(userID) {\n    return request({\n        url: `user/user_id/${userID}/invoice`,\n        method: 'get',\n    })\n}\n\n// 开具发票\nexport function createInvoice(userID, data) {\n    return request({\n        url: `user/user_id/${userID}/invoice`,\n        method: 'post',\n        data\n    })\n}\n","module.exports = __webpack_public_path__ + \"img/paypal.413b73aa.jpeg\";","module.exports = __webpack_public_path__ + \"img/coinbase.68854eb4.png\";","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/_sass-loader@7.3.1@sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OrderDetail.vue?vue&type=style&index=0&id=0db150e4&prod&lang=scss&scoped=true&\""],"sourceRoot":""}